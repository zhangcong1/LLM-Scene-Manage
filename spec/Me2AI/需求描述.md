# 大模型应用场景管理系统

## 项目概述
本项目是一个基于多模态大模型的应用场景管理系统，通过提示词描述和图片分析来实现行为识别和结构化分析。系统用于积累应用场景，供其他用户参考或进行场景分析技术性评估。

## 核心需求

### 用户体系

#### 用户角色与权限
- **管理员角色**
  - 大模型配置权限
  - 大模型应用场景检索与查看权限
  - 大模型应用场景创建权限
  - 大模型应用场景审批权限
  - 用户管理权限（添加/删除管理员）

- **普通用户角色**
  - 大模型应用场景检索与查看权限
  - 大模型应用场景创建权限
  - 大模型应用场景固化申请权限

- **游客角色**
  - 仅可查看已固化的应用场景
  - 无法创建场景（尝试创建时自动跳转登录页面）

#### 用户管理
- **用户注册**
  - 支持用户自主注册
  - 支持管理员配置域账号
  - 初始化测试账号：
    - 管理员账号：admin / admin123
    - 普通用户：test / test123

- **用户登录**
  - 登录状态保持，页面刷新不丢失
  - 支持登录/登出功能
  - 未登录状态下仅可浏览，创建场景时跳转登录

- **个人信息管理**
  - 个人中心查看：用户ID、用户名、邮箱、角色、注册时间
  - 头像上传和更换功能
  - 密码修改功能
  - 消息通知功能

#### 用户管理（管理员）
- 用户列表查看：所有用户基本信息
- 用户角色管理：管理员关联其他用户为管理员
- 用户删除：除admin用户外，其他用户可被删除
- 用户添加：从当前普通用户中选择添加

### 大模型配置

#### 模型管理
- **大模型配置**
  - 支持配置本地大模型服务资源
  - 配置信息参照Dify的模型添加规则（满足OpenAI协议）
  - 配置项：模型名称、API地址、API密钥、模型类型
  - 支持大模型增删改查

- **模型SystemPrompt配置**
  - 管理员可为每个模型配置SystemPrompt
  - SystemPrompt对用户不可见
  - 验证测试时，将SystemPrompt和UserPrompt传参给大模型
  - 提示词模板与模型关联，选择不同模型使用对应模板

- **提示词模板管理**
  - 管理员维护大模型提示词模板
  - 用于用户创建场景时一键优化用户提示词
  - 模板列表查看、新增、编辑、删除
  - 新添加的提示词在列表中实时展示

### 应用场景管理

#### 场景检索与查看
- **发现页面（场景检索）**
  - 查看已固化的应用场景
  - 多维度过滤：场景标签、场景名称、场景描述（模糊检索）、素材数量、准确率
  - 场景卡片展示：场景缩略图、场景名称、场景描述、标签、准确率、素材数量
  - 场景详情查看：
    - 场景应用说明
    - 准确率统计
    - 用户评论
    - 相关场景（通过复制或名称相近的场景，可点击跳转）
    - **提示词权限控制**：已发布场景的提示词内容对游客和普通用户隐藏，仅管理员可见

- **热门场景**
  - 首页展示热门场景（点击率较高的场景）
  - 支持点击查看详情

- **收藏功能**
  - 用户收藏喜欢的应用场景
  - 收藏列表查看
  - 取消收藏功能

#### 场景创建
- **创建场景**
  - 场景基本信息：场景名称、场景描述、场景标签
  - 提示词输入：UserPrompt字段
  - 缩略图配置：从验证图片中指定，未指定则默认第一张图
  - 大模型选择：选择已配置的模型进行验证

- **提示词优化**
  - 一键优化功能：使用对应模型的提示词模板，调用大模型对用户原始提示词进行优化
  - 优化结果弹窗展示
  - 用户可选择使用/取消/重新优化

- **场景验证**
  - 批量上传图片（50张以内）
  - 调用OpenAI协议的VL大模型进行图片分析
  - 验证过程将SystemPrompt和UserPrompt传参给大模型
  - 验证结果实时输出展示
  - 点击图片可查看该图片的分析结果
  - 对分析结果进行人工标注（准确/不准确）
  - 准确率自动计算

- **场景保存**
  - 保存为草稿：不提交固化，保存在草稿列表
  - 提交固化申请：效果好的场景可申请固化
  - 草稿列表查看：在"我的场景"中查看草稿
  - 草稿可再次编辑、删除（固化申请前）

#### 场景管理
- **我的场景**
  - 查看自己创建的场景
  - 场景状态分类：草稿、审批中、已发布、已拒绝
  - 场景编辑：草稿状态可编辑（固化申请前）
  - 场景删除：草稿状态可删除
  - 场景卡片展示缩略图、场景名称、状态、准确率、素材数量

- **场景固化审批**
  - 管理员查看固化申请场景
  - 场景审批：通过/拒绝
  - 审批通过后场景移至公共场景（已固化场景列表）
  - 管理员收到审批消息通知
  - 消息可点击跳转到对应审批页面

- **场景导出**
  - 用户可导出已发布场景
  - 导出需要管理员审批
  - 审批通过后可下载
  - 下载格式：JSON
  - 导出字段：提示词名称、场景描述、提示词、标签、准确率、素材数量

## 功能特性

### 智能提示词优化
- 基于大模型的提示词自动优化
- 优化结果弹窗展示
- 支持多次优化
- 用户自主选择是否使用

### 精准场景验证
- 批量图片验证（最多50张）
- 多模态大模型分析
- 实时结果展示
- 人工标注校准
- 准确率自动计算

### 灵活场景管理
- 草稿机制（暂存未完成场景）
- 审批流程（场景固化需审批）
- 状态追踪（草稿、审批中、已发布、已拒绝）
- 场景关联（相关场景推荐）

### 数据统计分析
- 场景点击率统计
- 准确率统计
- 素材数量统计
- 热门场景推荐

### 导出功能
- 场景导出为JSON格式
- 审批机制确保数据安全
- 管理员审核通过后方可下载

### 消息通知
- 实时消息推送
- 评论消息跳转
- 审批消息跳转
- 消息已读状态管理

### 系统配置

#### 数据库配置
- **数据库类型**：MySQL
- **数据库名称**：multimodal_app
- **用户名**：dhmysql
- **密码**：abc@12345
- **端口**：3306
- **连接URL**：mysql://dhmysql:abc@12345@localhost:3306/multimodal_app
- **自动初始化**：无需用户单独配置环境变量

#### 安全配置
- **JWT密钥**：7ujmko0abc@12345
- **登录状态保持**：使用JWT Token

#### 部署配置
- **容器化部署**：MySQL和场景管理系统放在同一个Docker容器中
- **数据库自动初始化**：系统启动时自动创建数据库和表结构
- **初始数据**：自动创建admin和test账号

### 数据持久化
- 场景数据持久化存储
- 用户数据持久化存储
- 模型配置持久化存储
- 提示词模板持久化存储
- 评论数据持久化存储
- 收藏关系持久化存储
- 导出申请记录持久化存储

### 权限控制
- **游客权限**
  - 仅可浏览已固化的应用场景
  - 无法查看提示词内容
  - 无法创建场景

- **普通用户权限**
  - 可浏览已固化的应用场景
  - 无法查看已发布场景的提示词内容
  - 可创建自己的场景
  - 可查看自己场景的提示词
  - 可申请固化场景
  - 可收藏场景
  - 可导出场景（需审批）

- **管理员权限**
  - 拥有普通用户所有权限
  - 可查看所有场景的提示词
  - 可配置大模型
  - 可配置提示词模板
  - 可审批场景固化申请
  - 可审批导出申请
  - 可管理用户

## 注意事项
1. 系统提示词（SystemPrompt）对普通用户隐藏，仅管理员可见
2. 已发布场景的提示词内容对游客和普通用户隐藏
3. 场景验证需要调用支持OpenAI协议的VL大模型
4. 图片上传限制为50张以内
5. 场景缩略图默认使用第一张验证图片，用户可自定义指定
6. 管理员可关联其他用户为管理员
7. 除admin用户外，其他用户可被删除
8. 场景导出需要管理员审批
